============================
hbsp (Hesperus BSP Compiler)
============================

-----
Usage
-----

hbsp {-r|-c} <input filename> <output filename> [-w<number>]

Flags:

-r		The input file contains rendering geometry (a list of polygons with
		textures).

-c		The input file contains collision geometry (a list of polygons with
		flags indicating whether or not each polygon is to be used when
		constructing navigation meshes).

-w		The ratio between the weights assigned to balance and split when
		choosing a split plane at each internal node: the default ratio is 4:1
		in favour of balance, and equivalent to specifying -w4. Note that it
		is perfectly valid to use decimal ratios, e.g. -w2.5 is fine.

Example Usage:

hbsp -r input.rgm output.rbt -w8

This inputs a file input.rgm containing rendering geometry and outputs a file
output.rbt containing a rendering BSP tree. The BSP construction process will
weight balance as 8 times more important than splits.

In this instance, the filenames are arbitrary, but .rgm and .rbt were chosen to
indicate "Rendering GeoMetry" and "Rendering BSP Tree" respectively.

-----
Input
-----

If the input file is specified to contain rendering geometry, it will be in the
form of a series of lines, each representing a single polygon and being of the
following form:

<n = vertex count> ( x1 y1 z1 u1 v1 ) ... ( xn yn zn un vn ) <texture>

If the input file is instead specified to contain collision geometry, each line
will instead be of the form:

<n = vertex count> ( x1 y1 z1 ) ... ( xn yn zn ) <navigation flag (0 or 1)>

------
Output
------

The output will be a BSP tree which has a split plane at each internal node,
and a list of polygons in each leaf. In practice, the output file will use
indexed polygons.

If the input contained rendering geometry (-r), the output file will be
structured as follows:

<p = polygon count>
1 <k = vertex count> ( x11 y11 z11 u11 v11 ) ... ( x1k y1k z1k u1k v1k ) <texture>
...
p <k' = vertex count> ( xp1 yp1 zp1 up1 vp1 ) ... ( xpk' ypk' zpk' upk' vpk' ) <texture>
***
<n = BSP tree node count>
0 <left> <right> <parent> <split plane = ( a b c d ) where ax+by+cz+d = 0>
...
i <parent> <m = leaf triangle count> [ <poly_1> ... <poly_m> ]
...
n ?

If the input instead contained collision geometry (-c), the output file will
take the form:

<p = polygon count>
1 <k> ( x11 y11 z11 ) ... ( x1k y1k z1k ) <navigation flag>
...
p <k'> ( xp1 yp1 zp1 ) ... ( xpk' ypk' zpk' ) <navigation flag>
***
<BSP tree output as above>
